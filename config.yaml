# =============================================================================
# Mossland Agentic Orchestrator - Configuration
# =============================================================================

# Model Configuration
models:
  claude:
    # Primary model for development and planning tasks
    default: opus
    # Fallback if opus is unavailable
    fallback: sonnet

  openai:
    # Primary model for review/evaluation (matches ChatGPT web)
    default: gpt-5.2-chat-latest
    # Fallback model
    fallback: gpt-5.2
    # Pinned version for reproducibility (optional, set to null for latest)
    pinned: null

  gemini:
    # Primary model for fast agentic tasks
    default: gemini-3-flash-preview
    # Fallback models in order of preference
    fallback: gemini-3-pro-preview
    fallback_secondary: gemini-2.5-pro
    # Pinned version for reproducibility (optional)
    pinned: null

# Execution Limits
limits:
  # Maximum planning iterations before escalation/failure
  planning_max_iterations: 3

  # Maximum development iterations before escalation/failure
  dev_max_iterations: 5

  # Rate limit handling
  rate_limit:
    max_retries: 5
    max_wait_seconds: 3600
    initial_backoff_seconds: 10
    backoff_multiplier: 2

  # Loop mode limits
  loop:
    max_steps: 100
    delay_seconds: 10
    lock_timeout_seconds: 300

# LLM Throttling Configuration (Prevents Local LLM Overheating)
throttling:
  # Global settings
  enabled: true

  # Local LLM (Ollama) specific - Very aggressive throttling for cooling
  ollama:
    # Minimum seconds between requests (increased for better cooling)
    min_request_interval: 15
    # Maximum concurrent requests (1 = sequential only)
    max_concurrent_requests: 1
    # Cooling period after N requests (seconds) - longer cooling
    cooling_period_seconds: 120
    # Number of requests before cooling (reduced)
    requests_before_cooling: 3
    # Request timeout (seconds)
    request_timeout: 180
    # Batch delay between multiple generations
    batch_delay_seconds: 30

  # Cloud API throttling (cost-conscious limits)
  cloud:
    # Minimum seconds between requests (increased to reduce costs)
    min_request_interval: 3
    # Maximum concurrent requests (reduced)
    max_concurrent_requests: 2
    # Request timeout (seconds)
    request_timeout: 60

# API Budget Configuration
budget:
  # Daily spending limit in USD
  daily_limit_usd: 5.0
  # Monthly spending limit in USD
  monthly_limit_usd: 150.0
  # Warn when usage reaches this percentage
  warning_threshold: 0.7
  # Critical alert at this percentage (prefer local models)
  critical_threshold: 0.9

# Quality Thresholds
quality:
  # Minimum review score to pass (1-10 scale)
  required_review_score: 7.0

  # Minimum test coverage percentage
  min_test_coverage: 70

  # Required review approvals (from different models)
  min_review_approvals: 1

# Stage Configuration
stages:
  ideation:
    # Number of ideas to generate per run
    ideas_per_run: 3

  planning:
    # Documents to generate
    documents:
      - PRD.md
      - ARCHITECTURE.md
      - TASKS.md
      - ACCEPTANCE_CRITERIA.md

  dev:
    # Auto-commit on each file creation
    auto_commit: true

  qa:
    # Run linting
    run_lint: true
    # Run type checking
    run_typecheck: true
    # Run unit tests
    run_tests: true

# Git Configuration
git:
  # Auto-push after commits
  auto_push: false

  # Branch naming pattern
  branch_pattern: "project/{project_id}"

  # Commit message template
  commit_template: |
    [{stage}] {description}

    {details}

    Generated by: Agentic Orchestrator
    Stage: {stage}
    Project: {project_id}
    Iteration: planning={planning_iter}, dev={dev_iter}

# Logging
logging:
  level: INFO
  format: "%(asctime)s - %(name)s - %(levelname)s - %(message)s"
  file: logs/orchestrator.log

# =============================================================================
# Trend Analysis Configuration
# =============================================================================
trends:
  # Idea generation mix
  ideas:
    traditional_count: 1  # Mossland-focused ideas
    trend_based_count: 2  # Trend-based ideas

  # Time periods to analyze
  periods:
    - 24h
    - 1w
    - 1m

  # Feed fetching settings
  fetch:
    timeout_seconds: 30
    max_retries: 3
    user_agent: "Agentic-Orchestrator/1.0"

  # Storage settings
  storage:
    directory: data/trends
    retention_days: 90

  # RSS Feed Sources by Category
  feeds:
    # AI / Research / Big Tech
    ai:
      - name: "OpenAI News"
        url: "https://openai.com/news/rss.xml"
      - name: "Google Blog"
        url: "https://blog.google/rss/"
      - name: "arXiv AI"
        url: "https://rss.arxiv.org/rss/cs.AI"
      - name: "TechCrunch"
        url: "https://techcrunch.com/feed/"
      - name: "Hacker News"
        url: "https://hnrss.org/frontpage"

    # Crypto / Web3
    crypto:
      - name: "CoinDesk"
        url: "https://www.coindesk.com/arc/outboundfeeds/rss/?outputType=xml"
      - name: "Cointelegraph"
        url: "https://cointelegraph.com/rss"
      - name: "Decrypt"
        url: "https://decrypt.co/feed"
      - name: "The Defiant"
        url: "https://thedefiant.io/feed/"
      - name: "CryptoSlate"
        url: "https://cryptoslate.com/feed/"

    # Finance / Macro
    finance:
      - name: "CNBC Finance"
        url: "https://www.cnbc.com/id/10000664/device/rss/rss.html"

    # Security
    security:
      - name: "The Hacker News"
        url: "https://feeds.feedburner.com/TheHackersNews?format=xml"
      - name: "Krebs on Security"
        url: "https://krebsonsecurity.com/feed/"

    # Dev / Tech Trends
    dev:
      - name: "The Verge"
        url: "https://www.theverge.com/rss/index.xml"
      - name: "Ars Technica"
        url: "https://feeds.arstechnica.com/arstechnica/index"
      - name: "Stack Overflow Blog"
        url: "https://stackoverflow.blog/feed"
